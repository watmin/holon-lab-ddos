;; Test scenario for Mask predicate (bitmask matching)
;; Tests TCP flag bit matching: SYN, ACK, RST, FIN
;; Note: Limited to 2 mask predicates per dimension per node

;; Rule 1: Drop TCP SYN packets to port 80 (bit 0x02 set)
{:constraints [(= proto 6) (= dst-port 80) (mask tcp-flags 0x02)] :actions [(drop)] :priority 100}

;; Rule 2: Rate-limit TCP ACK packets to port 443 (bit 0x10 set)
{:constraints [(= proto 6) (= dst-port 443) (mask tcp-flags 0x10)] :actions [(rate-limit 500 :name ["test" "tcp-ack"])] :priority 90}

;; Rule 3: Count TCP RST packets (bit 0x04 set) - different path
{:constraints [(= proto 6) (> dst-port 1024) (mask tcp-flags 0x04)] :actions [(count :name ["monitor" "tcp-rst"])]}

;; Rule 4: Drop suspicious TTL packets (different dimension)
{:constraints [(= proto 6) (< ttl 5)] :actions [(drop)] :priority 200}

;; Rule 5: Pass all other traffic
{:constraints [] :actions [(pass)] :priority 1}
