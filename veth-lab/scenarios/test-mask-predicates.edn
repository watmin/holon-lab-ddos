;; Test scenario for Mask predicate (bitmask matching)
;; Tests TCP flag bit matching: SYN, ACK, RST, FIN
;; Exercises guard edge overflow chaining (4 masks > 2 slots per node)

;; Rule 1: Drop all TCP SYN packets (bit 0x02 set)
{:constraints [(= proto 6) (mask tcp-flags 0x02)] :actions [(drop)] :priority 200}

;; Rule 2: Rate-limit TCP ACK packets (bit 0x10 set)
{:constraints [(= proto 6) (mask tcp-flags 0x10)] :actions [(rate-limit 500 :name ["test" "tcp-ack"])] :priority 150}

;; Rule 3: Count TCP RST packets (bit 0x04 set)
{:constraints [(= proto 6) (mask tcp-flags 0x04)] :actions [(count :name ["monitor" "tcp-rst"])]}

;; Rule 4: Drop TCP FIN packets (bit 0x01 set)
{:constraints [(= proto 6) (mask tcp-flags 0x01)] :actions [(drop)] :priority 50}
